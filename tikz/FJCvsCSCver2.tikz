%!TEX root=testfigum.tex
\begin{tikzpicture}
\useasboundingbox (-0.5cm,-9.3cm)rectangle(11cm,7cm);

\node[align=left] at (5.5,-5)
{\texttt{nk~~=~100;}\\
\texttt{lk~~=~1;}\\
\texttt{FJC~=~zeros(nk+1,~2);}\\
\texttt{r~~~=~rand(nk,~1);}\\
\texttt{for~i~=~2:nk+1}\\
\texttt{~~FJC(i,~1)~=~FJC(i-1,~1)~+~lk~*~cos(r(i-1)~*~2~*~pi);}\\
\texttt{~~FJC(i,~2)~=~FJC(i-1,~2)~+~lk~*~sin(r(i-1)~*~2~*~pi);}\\
\texttt{end}\\
\texttt{\% Determinação da estrutura CSC a partir da FJC gerada}\\
\texttt{CSC~=~FJC;}\\
\texttt{CSC(nk+1,~:)~=~CSC(1,~:);}\\
\texttt{for~i~=~nk:-1:1}\\
\texttt{~~dr~=~CSC(i,~:)~-~CSC(i+1,~:);}\\
\texttt{~~theta~=~atan2(dr(2),~dr(1));}\\
\texttt{~~CSC(i,~1)~=~CSC(i+1,~1)~+~lk~*~cos(theta);}\\
\texttt{~~CSC(i,~2)~=~CSC(i+1,~2)~+~lk~*~sin(theta);}\\
\texttt{end}};

\begin{axis}[%
width=6cm,
height=6cm,
scale only axis,
xmin=-15,
xmax=5,
ymin=-2,
ymax=10,
hide axis,
name=plot1,
title={FJC}
]
\addplot [
color=black,
solid,
mark size=2.5pt,
mark=*,
mark options={solid,fill=black},
forget plot
]
table[row sep=crcr]{
0 0\\
-0.0359534635777112 0.999353465224775\\
-0.978413588767783 1.33367204446726\\
-0.682563623554148 2.28890646495424\\
0.0743410317518025 1.63538114579959\\
-0.822779558153791 1.19359539776392\\
-1.60185411386996 0.566664112346087\\
-2.58958093309086 0.410472785468583\\
-3.21242935959367 -0.371869746676369\\
-3.4682027505772 0.594867018148879\\
-3.92251271833553 1.48571069309719\\
-3.61727552296498 0.533434339005424\\
-3.41803667700261 -0.446516620104053\\
-4.10263398079752 -1.17543810533874\\
-5.05179832692601 -0.860657159221478\\
-4.05455321028174 -0.78648049625289\\
-3.33567146462779 -0.0913481090304791\\
-3.29276403527912 -1.09042716121138\\
-4.22594862074044 -0.731029707885157\\
-4.46591120926599 -1.70181184415885\\
-3.50016560408655 -1.96130254934228\\
-3.53488085782371 -0.961905305420741\\
-2.76782198746937 -0.320328584045413\\
-3.5380492693521 0.317440915259413\\
-3.53412746134844 1.31743322494083\\
-3.43014014320752 2.31201184811039\\
-4.42121260608284 2.17868753176018\\
-5.1560384502441 2.85694336752771\\
-5.34954726604928 3.8380419039682\\
-6.32803532352806 3.63173843484709\\
-6.97677529019789 2.8707282800888\\
-6.67717797514429 3.82479402667689\\
-7.64962357258638 4.05792394756972\\
-6.86124866924489 4.67311904815269\\
-7.46839534199571 5.46770882770413\\
-7.9604893881869 4.59716678408809\\
-8.94312007549804 4.78273869024423\\
-8.55915124270638 5.70608474424816\\
-7.57646373852119 5.89135554366962\\
-8.56479052075719 5.73900669557737\\
-9.31065128758991 6.40510857704874\\
-10.256680678743 6.08102773671031\\
-9.31961387957932 5.73187760581373\\
-10.2522239939527 5.37099206361449\\
-9.45187561832646 5.97052728162291\\
-9.28495279843158 6.95649724678328\\
-9.2093156055953 5.95936184220683\\
-8.26863555033685 6.29865674879838\\
-8.8659866356463 5.49667689812903\\
-8.37600185497933 6.36840788571335\\
-9.37117424646433 6.27026558481289\\
-9.57065012320427 7.25016832212861\\
-10.1602658006456 6.44248437842578\\
-10.9191762225364 7.09367941184177\\
-11.7670574636316 7.623865606493\\
-10.853191536979 8.02988169989744\\
-11.5802972068163 8.71640726015759\\
-12.5647890322707 8.54097680210223\\
-13.5221838789495 8.82975891296233\\
-14.3654218794133 8.29221851952765\\
-13.3866657825203 8.08719046584974\\
-12.555563581735 8.64331017584911\\
-11.6216885858455 9.00090980120182\\
-10.9486553719669 8.26129754263915\\
-11.2833268896155 7.31896268958807\\
-10.7149049884026 6.49622546408921\\
-11.5247258292649 5.90954820553467\\
-11.287144213213 4.93818062541159\\
-11.9267680214541 5.70686871815873\\
-11.1264690548703 5.10726754730852\\
-10.4305693193252 5.82540650187671\\
-11.3203163855426 5.36895260698978\\
-11.5014144178227 4.38548755793908\\
-11.6970230181512 3.40480551187239\\
-11.9389817349602 2.43451896689709\\
-11.6956420348348 1.46457783964097\\
-12.6941376465132 1.51940952262635\\
-13.3664615068567 2.25966665823049\\
-13.1438365876318 1.28476248584218\\
-12.291720825819 1.80811583537772\\
-13.1660710561005 2.29341128642443\\
-12.1660785680041 2.28953523807432\\
-13.0405290129717 1.80442038641953\\
-12.9651382540452 0.807266319352416\\
-13.6647533303037 1.52178625964223\\
-14.6128415345525 1.2037787802264\\
-13.779883241811 0.65044300282422\\
-12.9409390753159 0.106225504480279\\
-13.8967684258409 0.400147692610059\\
-12.9432096791888 0.701354791934212\\
-12.9513916743081 -0.298611734983498\\
-13.9390397277879 -0.455300351218322\\
-13.7979904127391 0.534702219851194\\
-13.491626931936 -0.417212386418832\\
-13.9401725746437 0.476547540187822\\
-13.5717643734947 -0.453116591273721\\
-12.5718099312837 -0.462661930579983\\
-11.8791855847931 -1.18396042264032\\
-12.3518700084355 -0.302728650831178\\
-12.9244890685851 -1.12255022407341\\
-12.9438015612153 -0.122736727650997\\
};
\end{axis}

\begin{axis}[%
width=6cm,
height=6cm,
scale only axis,
xmin=-15,
xmax=5,
ymin=-2,
ymax=10,
hide axis,
at=(plot1.right of south east),
anchor=left of south west,
title={CSC}
]
\addplot [
color=black,
solid,
mark size=2.5pt,
mark=*,
mark options={solid,fill=black},
forget plot
]
table[row sep=crcr]{
7.63278329429795e-017 0\\
-0.0359534635777115 0.999353465224775\\
-0.978413588767783 1.33367204446726\\
-0.682563623554148 2.28890646495424\\
0.0743410317518023 1.63538114579959\\
-0.822779558153791 1.19359539776392\\
-1.60185411386996 0.566664112346087\\
-2.58958093309086 0.410472785468583\\
-3.21242935959367 -0.371869746676369\\
-3.4682027505772 0.594867018148879\\
-3.92251271833553 1.48571069309719\\
-3.61727552296498 0.533434339005424\\
-3.41803667700261 -0.446516620104053\\
-4.10263398079752 -1.17543810533874\\
-5.05179832692601 -0.860657159221478\\
-4.05455321028174 -0.78648049625289\\
-3.33567146462779 -0.0913481090304792\\
-3.29276403527912 -1.09042716121138\\
-4.22594862074044 -0.731029707885157\\
-4.46591120926599 -1.70181184415885\\
-3.50016560408655 -1.96130254934228\\
-3.53488085782371 -0.961905305420741\\
-2.76782198746937 -0.320328584045414\\
-3.5380492693521 0.317440915259413\\
-3.53412746134844 1.31743322494083\\
-3.43014014320752 2.31201184811039\\
-4.42121260608284 2.17868753176018\\
-5.1560384502441 2.85694336752771\\
-5.34954726604928 3.8380419039682\\
-6.32803532352806 3.63173843484709\\
-6.97677529019789 2.8707282800888\\
-6.67717797514429 3.82479402667689\\
-7.64962357258638 4.05792394756972\\
-6.86124866924489 4.67311904815269\\
-7.46839534199571 5.46770882770413\\
-7.9604893881869 4.59716678408809\\
-8.94312007549804 4.78273869024423\\
-8.55915124270639 5.70608474424815\\
-7.57646373852119 5.89135554366962\\
-8.56479052075719 5.73900669557737\\
-9.31065128758992 6.40510857704874\\
-10.256680678743 6.08102773671031\\
-9.31961387957934 5.73187760581372\\
-10.2522239939527 5.37099206361447\\
-9.45187561832646 5.97052728162289\\
-9.28495279843158 6.95649724678326\\
-9.2093156055954 5.9593618422068\\
-8.26863555033693 6.29865674879828\\
-8.86598663564635 5.49667689812892\\
-8.37600185497955 6.36840788571333\\
-9.37117424646474 6.27026558481493\\
-9.57065012320245 7.2501683221311\\
-10.1602658006754 6.44248437845135\\
-10.91917622257 7.09367941186283\\
-11.7670574636965 7.62386560646419\\
-10.8531915371128 8.02988170002376\\
-11.5802972071205 8.71640726010338\\
-12.5647890326024 8.54097680220228\\
-13.5221838793976 8.82975891267671\\
-14.3654218801405 8.29221851967999\\
-13.3866657834032 8.08719046525895\\
-12.5555635827525 8.64331017545949\\
-11.6216885878599 9.00090980341543\\
-10.9486553698435 8.26129754861804\\
-11.2833268957798 7.31896269851038\\
-10.714904595635 6.49622574863022\\
-11.5247261345202 5.90954945359387\\
-11.2871451277262 4.93818172445587\\
-11.9267691976791 5.70686959943299\\
-11.126477151615 5.10725919174608\\
-10.4305802510659 5.82540089350567\\
-11.3203200329079 5.3689327997602\\
-11.5014183578776 4.38546780460624\\
-11.6970278970834 3.40478594581018\\
-11.9389761711717 2.43449679681092\\
-11.6955649603107 1.4645736130344\\
-12.6940647443261 1.51932926407676\\
-13.3664338431631 2.25954531019381\\
-13.1441664879754 1.28455955500665\\
-12.2924105065297 1.80849824232745\\
-13.1669706906136 2.29341522946558\\
-12.1669802955424 2.28903233483726\\
-13.0403372788873 1.80195166426745\\
-12.9629051439658 0.804954039154184\\
-13.6575904036977 1.52426787185255\\
-14.6024892781166 1.19690550822195\\
-13.7693918587779 0.643779220751252\\
-12.9252732251199 0.107622776873645\\
-11.9292272776076 0.196462353888308\\
-10.9345430721456 0.0934898750191263\\
-9.97741003399309 -0.196158786771332\\
-8.97800289926001 -0.161729452699575\\
-7.97974917310933 -0.102657477734474\\
-6.98569576858896 -0.211551136693419\\
-5.98619503308244 -0.179955571784308\\
-4.98958396461978 -0.262213569679431\\
-3.9898312732086 -0.239974954252511\\
-2.99016775807587 -0.214035476376935\\
-1.99606816079494 -0.105564324977609\\
-0.99624935369155 -0.086528754002178\\
0 0\\
};
\end{axis}
\end{tikzpicture}%